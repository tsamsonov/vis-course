---
title: "Значки и картодиаграммы"
subtitle: "Визуализация пространственных данных"
date: today
date-format: long
author: "Самсонов Тимофей Евгеньевич"
execute:
  echo: false
  freeze: true
jupyter: python3
format:
  revealjs: 
    theme: [default, custom.scss]
    margin: 0.2
    width: 1280
    height: 720
    slide-number: true
    footer: "Самсонов Т. Е. Визуализация пространственных данных: курс лекций"
    header-includes: <link rel="stylesheet" media="screen" href="https://fontlibrary.org//face/pt-sans" type="text/css"/>
bibliography: references.yaml
mainfont: PT Sans
---

## Значки и картодиаграммы

![](images/clipboard-687983613.png){width="100%"}

## Значки и картодиаграммы

В западной (американской) школе эти способы изображения считаются одним — **proportional symbols**.

-   Символы диаграмм размещаются в точках, но точки бывают двух видов — реальные и концептуальные.
-   Реальные точки соответствуют точечным объектам в масштабе картографирования
-   Концептуальные точки используются для размещения диаграмм внутри площадных территориальных единиц.

::: callout-tip
## Концептуальные точки

Поиск оптимального местоположения для концептуальной точки — отдельная вычислительная задача
:::

## Вычисление размера

::: columns
::: {.column width="20%"}
![](images/clipboard-935605907.png){width="100%"}
:::

::: {.column width="80%"}
В отличие от картограмм для порпорциональных символов редко используется классификация, т.к. легко оценить размеры.

1.  Задается площадь символа $S_{min}$, соответствующая минимальному значению показателя $V_{min}$

2.  Площадь символа для произвольного значения $V$ будет равна:

    $$
    S = S_{min} \frac{V}{V_{min}}
    $$

    Однако шкала может быть и относительной, если задается максимальный размер диаграммы $S_{max}$:

    $$
    S = S_{min} + (S_{max} - S_{min}) \frac{V - V_{min}}{V_{max} - V_{min}}
    $$
:::
:::

## Оптимизация

::: columns
::: {.column width="50%"}
**Оптимальный размер**

-   Размер диаграмм должен быть таким, чтобы он не давал избыточного перекрытия или наоборот пустоты на карте.

-   Экспериментальные исследования говорят, что человек недооценивает размеры объектов. Можно использовать компенсацию *Флэннери*:

    $$
    \widehat S = 1.01902 \cdot S^{1.14325}
    $$
:::

::: {.column width="50%"}
**Оптимальное размещение**

-   Расположение концептуальной точки необходимо определять алгоритмически:

    -   центроид, точка в полигоне, центр максимальной вписанной окружности.

-   В случае использования значков они могут быть раздвинуты для обеспечения читаемости в ущерб точности расположения
:::
:::

## Концептуальная точка

**Центроид**

![](images/clipboard-1595657423.png)

## Концептуальная точка

**Точка на поверхности**

![](images/clipboard-3372775963.png)

## Концептуальная точка

**Центр максимальной вписанной окружности**

![](images/clipboard-547672974.png)

## Центр макс. вписанной окружности

Построить диаграмму Вороного для точек на границе региона

![](images/clipboard-1321400217.png)

## Центр макс. вписанной окружности

Отобрать только те ребра диаграммы, которые располагаются внутри регионы (`CONTAINS_PROPERLY`):

![](images/clipboard-1896654347.png)

## Центр макс. вписанной окружности

Для всех вершин ребер вычислить расстояние до границы региона

![](images/clipboard-574950881.png)

## Центр макс. вписанной окружности

Выбрать среди них вершину с максимальным расстоянием

![](images/clipboard-185457508.png)

## Библиография
